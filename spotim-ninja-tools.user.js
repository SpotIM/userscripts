// ==UserScript==
// @name        SpotIM Ninja Tools
// @version     4.0.4
// @author      dutzi
// @description A bunch of shortcuts to make our lives easier
// @match       http*://*/*
// @namespace   https://spot.im/
// @noframes    true
// @resource    bigBlueFont https://rawcdn.githack.com/SpotIM/userscripts/53c2ab94cf3523830e17d299ed8abd533822d0c5/ninja-tools/src/assets/BigBlue_Terminal_437TT.TTF
// @resource    welcomeImage https://github.com/SpotIM/userscripts/raw/master/ninja-tools/welcome-background.png
// @grant       GM_setValue
// @grant       GM_getValue
// @grant       GM_openInTab
// @grant       GM_setClipboard
// @grant       GM_deleteValue
// @grant       GM_notification
// @grant       GM_getResourceURL
// @grant       unsafeWindow
// ==/UserScript==

!function(n){var t={};function e(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return n[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}e.m=n,e.c=t,e.d=function(n,t,o){e.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:o})},e.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,t){if(1&t&&(n=e(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var i in n)e.d(o,i,function(t){return n[t]}.bind(null,i));return o},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},e.p="",e(e.s=13)}([function(n,t,e){"use strict";var o=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t},i=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(t,"__esModule",{value:!0});const s=o(e(4)),a=i(e(1)),r=o(e(5));let l,d,u,c,p,f,m,h;function _(){m=!1,h.parentNode||document.body.appendChild(h)}function g(n){function t(){h&&h.parentNode&&(h.parentNode.removeChild(h),w(0))}n?t():new Promise(n=>{if(m){const t=setInterval(()=>{m||(clearInterval(t),n())},100)}else n()}).then(t)}function w(n){u.style.width=100*n+"%"}function v(n){l.style.backgroundColor=n.bg,l.querySelector(".sptmninja_title")&&(l.querySelector(".sptmninja_title").style.backgroundColor=n.bg),l.style.borderColor=n.border}t.set=function(n,{timeout:t,color:e,step:o,numSteps:i,title:y,emoji:b,belowNotificationPopover:x,overflow:j}={}){!function(){if(c)return;c=!0,l=document.createElement("div"),l.className="sptmninja_message";const n=document.createElement("div");n.className="sptmninja_inset_shadow",d=document.createElement("div"),u=document.createElement("div"),u.className="sptmninja_message_progress";const t=document.createElement("div");t.innerText="×",t.className="sptmninja_close_button",t.addEventListener("click",()=>{g(!0),s.stop()}),l.appendChild(d),l.appendChild(t),l.appendChild(n),l.appendChild(u),l.addEventListener("mouseenter",()=>{m=!0}),l.addEventListener("mouseleave",()=>{m=!1}),v(a.default.default),h=document.createElement("div"),document.body.appendChild(h),r.set(h.attachShadow({mode:"open"})),r.get().appendChild(l)}(),function(){if(p)return;p=!0;const n=document.createElement("style");n.innerHTML="\n    @keyframes spotim-scroll-to-comments-appear {\n      0% {\n        transform: scale(0.7);\n        opacity: 0;\n      }\n      90% {\n        transform: scale(1.02);\n        opacity: 1;\n      }\n      100% {\n        transform: scale(1);\n        opacity: 1;\n      }\n    }\n\n    .sptmninja_message {\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      text-align: center;\n      background: red;\n      color: white;\n      font-weight: bold;\n      font-family: Helvetica;\n      font-size: 18px;\n      padding: 10px;\n      line-height: 1.5;\n      z-index: 100000000000;\n      animation: spotim-scroll-to-comments-appear 0.2s ease-out;\n      direction: ltr;\n      max-width: 600px;\n      margin: 5em auto;\n      border-radius: 1em;\n      overflow: hidden;\n      border: 3px solid;\n      box-shadow: 0px 1px 4px #00000075, 0px 1px 24px #00000075, 0px 0px 40px 5px #0000001c inset;\n      text-shadow: 0px 2px #00000033;\n    }\n\n    .sptmninja_below_notifications {\n      margin: 10em auto;\n    }\n\n    .sptmninja_message .sptmninja_table {\n      display: table;\n      border: none;\n      width: 100%;\n      text-align: left;\n      border-collapse: collapse;\n      margin: 0;\n      color: inherit;\n      font-weight: inherit;\n    }\n\n    .sptmninja_message .sptmninja_table .sptmninja_tr {\n      display: table-row;\n      background: initial !important;\n    }\n\n    .sptmninja_message .sptmninja_table .sptmninja_td {\n      display: table-cell;\n      padding: initial;\n      border: none;\n      border-bottom: 1px solid #00000021;\n    }\n\n    .sptmninja_message .sptmninja_table .sptmninja_tr:last-child .sptmninja_td {\n      border-bottom: none;\n    }\n\n    .sptmninja_message .sptmninja_table .sptmninja_td:first-child {\n      text-align: right;\n      padding-right: 12px;\n    }\n\n    .scrollable_area {\n      max-height: calc(100vh - 300px);\n      overflow-y: auto;\n    }\n\n    .sptmninja_close_button {\n      position: absolute;\n      top: 0px;\n      right: 0px;\n      color: #ffffff73;\n      cursor: pointer;\n      padding: 10px;\n      line-height: 11px;\n      z-index: 11;\n    }\n\n    .sptmninja_close_button:active {\n      text-shadow: 0px -2px #00000033;\n    }\n\n    .sptmninja_inset_shadow {\n      position: absolute;\n      top: 0px;\n      left: 0px;\n      right: 0px;\n      bottom: 0px;\n      box-shadow: 0px 0px 3px black inset;\n      z-index: 100;\n      border-radius: 14px;\n      pointer-events: none;\n    }\n\n    .sptmninja_title {\n      padding: 12px 0px 10px;\n      box-shadow: 0px -20px 50px -24px #00ffff36 inset, 0px 1px 1px #00000038;\n      margin: -10px -10px 8px;\n      position: relative;\n      z-index: 10;\n    }\n\n    .sptmninja_titleIcon {\n      margin-inline-end: 12px;\n    }\n\n    .sptmninja_muted_text {\n      text-shadow: none;\n      color: #ffffff73;\n      font-weight: normal;\n    }\n\n    .sptmninja_weight_normal {\n      font-weight: normal;\n    }\n\n    .sptmninja_muted_result {\n      font-weight: normal;\n      opacity: 0.8;\n    }\n\n    .sptmninja_weight_bold {\n      font-weight: bold;\n    }\n\n    .sptmninja_pallete_row_main_col {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n    }\n\n    .palette_row_description {\n      text-overflow: ellipsis;\n      overflow: hidden;\n      white-space: nowrap;\n    }\n\n    .palette_row_recently_used {\n      font-weight: normal;\n      font-size: 0.7em;\n      opacity: 0.7;\n      margin: 0px 7px;\n      flex: 0 0 auto;\n      transform: translateX(26px);\n    }\n\n    [data-selected] .palette_row_recently_used {\n      transform: translateX(0px);\n    }\n\n    .sptmninja_margin_top {\n      margin-top: 12px;\n    }\n\n    .sptmninja_emoji {\n      position: absolute;\n      font-size: 6em;\n      transform: translateY(-50%);\n      top: 50%;\n      left: -15px;\n      z-index: -1;\n      text-shadow: 0px 0px 10px #0000006e;\n      height: 150px;\n    }\n\n    .sptmninja_title + .sptmninja_emoji {\n      margin-top: 20px;\n    }\n\n    .sptmninja_message_progress {\n      background: black;\n      position: absolute;\n      left: 0px;\n      height: 100%;\n      width: 0%;\n      top: 0px;\n      opacity: 0.2;\n      z-index: -1;\n      transition: width 0.2s ease-out;\n    }\n\n    .sptmninja_code {\n      font-family: monaco;\n      font-size: 13px;\n      color: #d3d5da;\n      margin: 10px 0px;\n      display: inline-block;\n      background: #2b579c;\n      padding: 4px 8px;\n      border-radius: 5px;\n    }\n\n    .sptmninja_mono {\n      background: #0000003d;\n      padding: 1px 7px;\n      border-radius: 5px;\n      box-shadow: 0px 1px 0px #00000063;\n      color: white;\n      font-family: monaco;\n      font-size: 15px;\n      margin: 4px 0px;\n      display: inline-block;\n    }\n\n    .sptmninja_hidden {\n      opacity: 0.5;\n    }\n\n    .sptmninja_detailed_description {\n      font-weight: normal;\n      font-size: 0.8em;\n      margin: 2px 0px 5px;\n      color: #ffffffbf;\n    }\n\n    .sptmninja_mono a {\n      color: inherit;\n      text-decoration: none;\n      outline: none;\n    }\n\n    .sptmninja_mono a:focus, .sptmninja_mono a:hover {\n      text-decoration: underline;\n    }\n\n    .sptmninja_input {\n      width: 100%;\n      padding: 10px;\n      box-sizing: border-box;\n      font-size: 20px;\n      background: #ffffff33;\n      border: none;\n      border-radius: 6px;\n      outline: none;\n      box-shadow: 0px 3px 9px #0000002e inset;\n      border-top: 1px solid #0000004f;\n      border-bottom: 1px solid #ffffff42;\n      color: white;\n      font-weight: bold;\n    }\n\n    .sptmninja_results {\n      max-height: 270px;\n      overflow-y: scroll;\n      padding-right: 10px;\n    }\n\n    .sptmninja_input + .sptmninja_results:not(:empty) {\n      margin-top: 12px;\n    }\n\n    .sptmninja_results .sptmninja_tr {\n      cursor: pointer;\n    }\n\n    .sptmninja_input + .sptmninja_results .sptmninja_table .sptmninja_tr .sptmninja_td:first-child {\n      padding-right: 20px;\n    }\n\n    .sptmninja_input + .sptmninja_results .sptmninja_table .sptmninja_tr .sptmninja_td:nth-child(2) {\n      width: 100%;\n    }\n\n    ::-webkit-scrollbar {\n      width: 6px;\n    }\n\n    ::-webkit-scrollbar-track {\n      border-radius: 10px;\n      background: #0000001a;\n    }\n\n    ::-webkit-scrollbar-thumb {\n      border-radius: 10px;\n      background: #00000036;\n    }\n\n    .gutterActions {\n      display: flex;\n      margin: -10px;\n      padding: 10px 0px;\n      border-top: 1px solid #0000000f;\n      background: linear-gradient(#ffffff2b, #0000001a);\n      margin-top: 0px;\n      z-index: 1;\n      position: relative;\n    }\n\n    .gutterActions .gutterActionsButton {\n      font-size: inherit;\n      font-family: inherit;\n      color: inherit;\n      background: none;\n      border: none;\n      flex: auto;\n      margin: -10px 0px;\n      border-right: 1px solid #00000038;\n      cursor: pointer;\n      padding: 1em 0px;\n    }\n  ",r.get().appendChild(n)}(),_();let k=n;"scroll"===j&&(k=`<div class="scrollable_area">${k}</div>`);let C="";return y&&(C=`<div class="sptmninja_title">${y}</div>`),b&&(C+=`<div class="sptmninja_emoji">${b}</div>`),k=C+k,d.innerHTML!==k&&(d.innerHTML=k),x?l.classList.add("sptmninja_below_notifications"):l.classList.remove("sptmninja_below_notifications"),clearTimeout(f),t&&(f=setTimeout(()=>{g()},t)),e&&v(e),isNaN((null!=o?o:0)/(null!=i?i:0))?w(0):w(o/i),d},t.show=_,t.hide=g},function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={default:{bg:"#467FDB",border:"#46abdb"},error:{bg:"#f44336",border:"#d81054"},success:{bg:"#4caf50",border:"#4dd052"}}},function(n,t,e){"use strict";var o=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t},i=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(t,"__esModule",{value:!0});const s=o(e(0)),a=i(e(9)),r=i(e(1));t.isTopMostFrame=()=>window.parent===window,t.findConversation=()=>document.querySelector("[data-conversation-id]")||document.querySelector('[data-spotim-app="conversation"]')||document.querySelector('[data-spotim-module="conversation"]'),t.getLauncherEl=n=>{const e=document.querySelector('script[data-spotim-module="spotim-launcher"]');return!e&&n&&(t.isTopMostFrame()?s.set("Could not find launcher script",{timeout:2e3,color:r.default.error,emoji:"😕"}):(window.parent.focus(),s.set(`${a.default.focusWarning}<br/>Could not find launcher script`,{timeout:3e3,color:r.default.error,emoji:"😕️"}))),e},t.isProduction=n=>unsafeWindow.__SPOTIMENV__?"production"===unsafeWindow.__SPOTIMENV__:n.src.indexOf("//launcher.spot.im")>-1,t.getSpotId=n=>{const t=n.src.split("/").pop().split("?")[0];return"launcher-bundle.js"===t?n.getAttribute("data-spot-id"):t},t.getPostId=n=>n.getAttribute("data-post-id"),t.getSpotimVersion=()=>unsafeWindow.__SPOTIM__&&"IFRAME"!==(t.findConversation()||{}).tagName?2:1,t.getConfigUrl=()=>{const n=t.getLauncherEl(!0);return`https://api-2-0.spot.im/v1.0.0/config/launcher/${t.getSpotId(n)}/${t.getPostId(n)}/vendor,init,conversation`},t.padTime=n=>1===n.length?`0${n}`:n,t.renderTable=n=>"<div class='sptmninja_table'><tbody>"+n.map(n=>"<div class='sptmninja_tr'><div class='sptmninja_td'>"+n.join("</div><div class='sptmninja_td'>")+"</div></div>").join("")+"</tbody></div>",t.createElement=(n,t,e="div")=>`<${e} class="sptmninja_${t}">${n}</${e}>`,t.getRandomOptimisticEmoji=()=>{const n=["🎈","🚀","🌈","🦄"];return n[Math.floor(Math.random()*n.length)]},t.onFoundSpotimObject=n=>{function t(){unsafeWindow.__SPOTIM__&&(clearInterval(e),n())}const e=setInterval(t,500);t()}},function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.get=()=>GM_getValue("prefs",{}),t.set=n=>GM_setValue("prefs",Object.assign(Object.assign({},t.get()),n))},function(n,t,e){"use strict";var o=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t},i=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(t,"__esModule",{value:!0});const s=o(e(0)),a=o(e(2)),r=i(e(9)),l=i(e(1));let d,u,c,p,f;function m(){if(d)return;let n=new IntersectionObserver(n=>{f=n[0].isIntersecting},{rootMargin:"0px",threshold:0});s.set("Looking for conversation element",{title:"Scroll To Conversation"}),d=!0,u=setInterval(()=>{let t;t=a.findConversation(),t?(n.observe(t),f||(t.scrollIntoView(),window.scrollBy(0,-200)),s.set('Hit <span class="sptmninja_mono">escape</span> to stop',{title:"Scroll To Conversation",color:l.default.success,emoji:"😃"}),function(n){Object.assign(n.style,{boxShadow:"rgb(76, 175, 80) 0px 0px 0px 4px,\n        rgb(26, 216, 34) 0px 0px 0px 5px,\n        #00000036 0px 0px 40px 12px,\n        #00000085 0px 0px 4px 5px,\n        black 0px 0px 40px -4px",borderRadius:"8px"}),n.dataset.sptmninjaHighlighted=!0,p=!0}(t)):(c||(window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"}),c=!0),a.isTopMostFrame()?s.set("Element not found. Try scrolling up and down a bit.",{color:l.default.error,emoji:"😕",title:"Scroll To Conversation"}):(window.parent.focus(),s.set(`${r.default.focusWarning}<br/>Scroll To Conversation... not found. Try scrolling up and down a bit.`,{color:l.default.error,timeout:3e3,emoji:"😕"}),h({hideMessage:!1})))},100)}function h({hideMessage:n}={hideMessage:!0}){p&&([...document.querySelectorAll("[data-sptmninja-highlighted]")].forEach(n=>{n.style.boxShadow=null,n.style.borderRadius=null,delete n.dataset.sptmninjaHighlighted}),p=!1),d&&(n&&s.hide(),clearInterval(u),d=!1,c=!1)}t.start=m,t.stop=h,t.toggle=function(){d?h():m()}},function(n,t,e){"use strict";let o;Object.defineProperty(t,"__esModule",{value:!0}),t.get=function(){return o},t.set=function(n){o=n}},function(n,t,e){"use strict";var o=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function a(n){try{l(o.next(n))}catch(n){s(n)}}function r(n){try{l(o.throw(n))}catch(n){s(n)}}function l(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,r)}l((o=o.apply(n,t||[])).next())}))},i=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t},s=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(e(4)),r=i(e(0)),l=i(e(2)),d=i(e(3)),u=i(e(15)),c=i(e(16)),p=i(e(7)),f=i(e(17)),m=(s(e(12)),s(e(1))),h=s(e(18)),_=s(e(8));let g={sss:()=>{a.toggle()},ssc:()=>{a.stop();const n=l.getLauncherEl(!0);if(n){const t=l.getSpotId(n);GM_setClipboard(t),r.set(`Copied ${t} to clipboard!`,{timeout:2e3,color:m.default.default,emoji:"😃"})}},ssi:()=>{function n(n){return unsafeWindow.__sptmninja_copy=n=>{const t=n.currentTarget;GM_setClipboard(t.parentElement.children[0].innerText),t.classList.add("showCheckmark"),setTimeout(()=>{t.classList.remove("showCheckmark")},1e3)},`\n        <style>\n          .infoLine {\n            display: flex;\n            justify-content: space-between;\n            font-weight: normal;\n          }\n\n          .copyButton {\n            border: none;\n            text-shadow: none;\n            display: inline-block;\n            margin-top: 0px;\n            right: 9px;\n            font-size: 0.8em;\n            background: #00000030;\n            padding: 1px 7px;\n            border-radius: 5px;\n            cursor: pointer;\n            margin: 2px;\n            font-family: inherit;\n            color: inherit;\n            line-height: inherit;\n            visibility: hidden;\n            position: relative;\n            outline: none;\n          }\n\n          .copyButton .checkmark {\n            position: absolute;\n            left: 50%;\n            transform: translateX(-50%);\n            opacity: 0;\n          }\n\n          .copyButton.showCheckmark .checkmark {\n            opacity: 1;\n          }\n\n          .copyButton.showCheckmark > div:nth-child(2) {\n            visibility: hidden;\n          }\n\n          .infoLine:hover .copyButton {\n            visibility: visible;\n          }\n        </style>\n        <div class="infoLine">\n          <div>${n}</div>\n          <button onClick="__sptmninja_copy(event)" class="copyButton">\n            <div class="checkmark">✔</div>\n            <div>Copy</div>\n          </button>\n        </div>\n      `}a.stop();const t=l.getLauncherEl(!0);if(t){const e=l.getSpotId(t),o=l.getPostId(t),i=(l.getSpotimVersion(),l.isProduction(t)?"Production":"Dev");r.set(l.renderTable([["Spot Id",n(e)],["Post Id",n(o)],["Environment",n(i)]]),{color:m.default.default,title:"Spot Info"})}},ssv:()=>o(void 0,void 0,void 0,(function*(){if(a.stop(),unsafeWindow.__SPOTIM__){const n=unsafeWindow.__SPOTIM__.SERVICES.configProvider._data.assets_config;if(n.filter(n=>n.url.indexOf("tags")>-1).length){const t=l.renderTable(n.filter(n=>n.url.indexOf("tags")>-1).sort((n,t)=>n.name<t.name?-1:1).map(n=>[`<span class="sptmninja_mono"><a target="_blank" href="${n.url}">${n.url.match(/tags\/(.*?)\//)[1]}</a></span>`,n.name]))+`<div class="sptmninja_muted_text sptmninja_margin_top">Page loaded at ${h.default}</div>`;r.set(t,{color:m.default.default,emoji:l.getRandomOptimisticEmoji(),title:"Assets"})}else r.set("No assets found. Are you running locally?",{timeout:2e3,color:m.default.error,emoji:"😕"})}else r.set("Could not find __SPOTIM__ object",{timeout:2e3,color:m.default.error,emoji:"😕"})})),ssa:()=>{a.stop();const n=l.getLauncherEl(!0);n&&(l.isProduction(n)?u.open({spotId:l.getSpotId(n)}):window.open("https://admin.staging-spot.im/internal/super-admin"))},ssda:()=>{a.stop();const n=l.getLauncherEl(!0);n&&(l.isProduction(n)?window.open("https://admin.spot.im/internal/super-admin"):window.open("https://admin.staging-spot.im/internal/super-admin"))},sso:()=>{a.stop();const n=l.getLauncherEl(!0);l.isProduction(n)&&window.open(l.getConfigUrl())},ssn:()=>o(void 0,void 0,void 0,(function*(){a.stop(),c.toggleNotifyOnChange()})),__ssa:()=>o(void 0,void 0,void 0,(function*(){const n=yield d.get().showVersionsOnLoad;yield d.set({showVersionsOnLoad:!n}),n?r.set("Stopped showing you asset versions on page load",{timeout:4e3,emoji:"❌",color:m.default.default}):r.set("I will now show you asset versions on page load!",{timeout:4e3,emoji:"🤠",color:m.default.success})})),__ssn:()=>{p.show()},__ssc:()=>{u.openCredentialsForm()},__ssp:()=>{a.stop();const n=l.getLauncherEl(!0);if(n){const t=l.getPostId(n);GM_setClipboard(t),r.set(`Copied ${t} to clipboard!`,{timeout:2e3,color:m.default.default,emoji:"😃"})}},ssh:()=>{a.stop(),f.show()}};g=_.default.reduce((n,t)=>Object.assign(Object.assign({},n),{[t.keyCombo]:()=>o(void 0,void 0,void 0,(function*(){try{const n=JSON.parse(unsafeWindow.localStorage.getItem("SPOT_AB")),e=n[t.id].variant,o=String.fromCharCode(e.charCodeAt(0)+1),i=t.variants.find(n=>n.id===o)||t.variants[0];let s;n[t.id].variant=i.id,s=i.statusText,r.set(s,{emoji:"😃",color:m.default.success}),unsafeWindow.localStorage.setItem("SPOT_AB",JSON.stringify(n))}catch(n){r.set("Are you sure this spot has this test?",{title:`Couldn't ${t.description}`,emoji:"😞",color:m.default.error})}}))}),g),t.default=g},function(n,t,e){"use strict";var o=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function a(n){try{l(o.next(n))}catch(n){s(n)}}function r(n){try{l(o.throw(n))}catch(n){s(n)}}function l(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,r)}l((o=o.apply(n,t||[])).next())}))},i=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}},s=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t};Object.defineProperty(t,"__esModule",{value:!0});const a=i(e(8)),r=s(e(3)),l=s(e(0)),d=i(e(10)),u=[{version:"4.0.2",list:[{title:"Added Set Credentials Command and Credentials Form"}]},{version:"3.7",list:[{title:"Added Recently Used commands",description:"The command you last used will show up first, next time you hit Ctrl+S"}]},{version:"3.4",list:[{title:"The following commands were added:",list:[{title:"Toggle Show Asset Versions on Load",description:"If enabled, will show the asset versions popup once the page loads"},...a.default.map(n=>({title:n.description}))]}]}];function c(n,t){const e=t?"latest":"";return(`\n    <div class="whatsNewTitle ${e}">${t?`⭐️ What's New in v${n.version}:`:"✨ v"+n.version+":"}</div>\n      <ul class="${e}">\n        ${function n(t){return t.map(t=>`\n        <li>\n          ${t.title}\n          ${t.description?`<div class="whatsNewDescription">${t.description}</div>`:""}\n        </li>\n        ${t.list?"<ul>"+n(t.list)+"</ul>":""}\n      `).join("")}(n.list)}\n      </ul>\n    `)}function p(n){return o(this,void 0,void 0,(function*(){const t=GM_info.script.version,{dontShowWhatsNew:e}=yield r.get();yield r.set({lastWhatsNewVersion:t});const i=function(n){const[t,e]=d.default([n?"Don't Show Me What's New On Upgrade":"Show Me What's New Next Upgrade","Close"]);return{html:`\n    <style>\n      .whatsNewWrapper {\n        text-align: left;\n        margin-top: -7px;\n        font-weight: normal;\n      }\n\n      .whatsNewContent {\n        max-height: calc(100vh - 10em - 180px);\n        overflow-y: auto;\n        overflow-x: hidden;\n        padding: 0px 10px;\n        margin: 0px -10px;\n        padding-top: 1em;\n      }\n\n      .whatsNewContent .whatsNewTitle {\n        margin-left: -10px;\n        padding-left: 1em;\n        margin-right: -10px;\n        padding-top: 1em;\n        font-weight: bold;\n        padding-bottom: 0em;\n      }\n\n      .whatsNewContent .whatsNewTitle.latest {\n        text-shadow: 0px 0px 10px #ffffff91;\n      }\n\n      .whatsNewContent .whatsNewTitle:not(.latest) {\n        opacity: 0.75;\n      }\n\n      .whatsNewContent .whatsNewPreviousTitle {\n        margin-left: -10px;\n        padding-left: 1em;\n        margin-right: -10px;\n        border-top: 1px solid #00000040;\n        padding-top: 1em;\n        font-weight: bold;\n        padding-bottom: 0em;\n        border-bottom: 1px solid #3c3c3c26;\n        padding: 0.5em 1em;\n        background: #00000017;\n        text-align: left;\n      }\n\n      .whatsNewFeatureRequest {\n        text-align: left;\n        padding: 0.5em calc(0.5em + 10px);\n        background: #8BC34A;\n        margin: 0px -10px;\n        text-align: left;\n        border-top: 1px solid #3F51B5;\n      }\n\n      .whatsNewFeatureRequest a {\n        color: white;\n      }\n\n      .whatsNewContent .whatsNewTitle:first-child {\n        margin-top: -18px;\n        border: none;\n        background: none;\n      }\n\n      .whatsNewContent p {\n        font-weight: bold;\n        margin: 0px 0.6em;\n      }\n\n      .whatsNewContent ul {\n        margin-top: 0.4em;\n        list-style: disc;\n        margin-bottom: 0px;\n      }\n\n      .whatsNewContent ul:last-child {\n        margin-bottom: 1em;\n      }\n\n      .whatsNewContent ul.latest {\n        text-shadow: 0px 0px 10px #ffffff70;\n      }\n\n      .whatsNewContent ul:not(.latest) {\n        opacity: 0.75;\n      }\n\n      .whatsNewContent .whatsNewDescription {\n        font-size: 0.8em;\n        opacity: 0.6;\n      }\n    </style>\n    <div class="whatsNewWrapper">\n      <div class="whatsNewContent">\n        ${c(u[0],!0)}\n        ${u.slice(1).map(n=>c(n)).join("")}\n      </div>\n      <div class="whatsNewFeatureRequest">\n        💡 Got a feature request? <a href="slack://channel?id=D9SQV11P1&team=T0460KVUF">Hit me up on Slack!</a>\n      </div>\n      ${t()}\n    </div>\n  `,addListeners:e}}(!e);l.set(i.html,{title:n?"SpotIM Ninja Tools Upgraded! 🥳":"SpotIM Ninja Tools Changelog"}),i.addListeners(n=>{0===n?function(){o(this,void 0,void 0,(function*(){const{dontShowWhatsNew:n}=yield r.get();yield r.set({dontShowWhatsNew:!n}),l.hide(!0)}))}():l.hide(!0)})}))}t.show=p,t.showIfUpgraded=function(){return o(this,void 0,void 0,(function*(){if(yield r.get().isNotFirstRun){const{lastWhatsNewVersion:n,dontShowWhatsNew:t}=yield r.get(),e=GM_info.script.version;if(t)return;n&&n===e||!u.find(n=>n.version===e)||p(!0),yield r.set({lastWhatsNewVersion:e})}}))},t.setCurrentVersionAsLastShown=function(){return o(this,void 0,void 0,(function*(){const n=GM_info.script.version;yield r.set({lastWhatsNewVersion:n})}))}},function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=[{name:"Redesign",description:"Toggle Redesign",id:35,variants:[{id:"A",statusText:"Redesign Disabled"},{id:"B",statusText:"Redesign Enabled"}]},{name:"Reactions",description:"Cycle Through Reaction Variants",id:34,variants:[{id:"A",statusText:"Reactions Disabled"},{id:"B",statusText:"Reactions Enabled"},{id:"C",statusText:"Reactions Enabled (With Ads)"}]},{name:"Show Scores",description:"Toggle Show Scores Before/After Click",id:37,variants:[{id:"A",statusText:"Showing Scores After Click"},{id:"B",statusText:"Showing Scores Before Click"}]}].map((n,t)=>Object.assign(Object.assign({},n),{keyCombo:`__ssab${t}`}))},function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={focusWarning:"⚠️⚠️️⚠️ TRY AGAIN. (Moving focus to parent frame) ️⚠️⚠️️⚠️"}},function(n,t,e){"use strict";var o=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t};Object.defineProperty(t,"__esModule",{value:!0});const i=o(e(5));t.default=function(n){return[function(){return`\n        <div class="gutterActions">\n        ${n.map((n,t)=>`\n          <button class="gutterActionsButton" id="gutterButton${t}">\n            ${n}\n          </button>\n        `).join("")}\n      </div>\n    `},function(t){n.forEach((n,e)=>{var o;null===(o=i.get().querySelector(`#gutterButton${e}`))||void 0===o||o.addEventListener("click",t.bind(null,e))})}]}},function(n,t,e){"use strict";var o=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(t,"__esModule",{value:!0});const i=[{keyCombo:"sss",description:"Scroll to Conversation"},{keyCombo:"ssi",description:"Show Info"},{keyCombo:"ssc",description:"Copy Spot ID to Clipboard"},{keyCombo:"ssa",description:"Open Host Panel",detailedDescription:"Will require you to enter the username and password you use to log in to the host panel on first run and won't work if you use Google to sign in",keywords:"admin"},{keyCombo:"ssv",description:"Show Asset Versions",keywords:"assets"},{keyCombo:"sso",description:"Open Config Data"},{keyCombo:"ssn",description:"Notify On Asset Updates",detailedDescription:"Will start constantly checking if an update to one of our products was released for this spot and pop a notification once that happens",keywords:"changes"},{keyCombo:"ssh",description:"Show Help"},{keyCombo:"__ssn",description:"What's New?",unlisted:!0},{keyCombo:"__ssa",description:"Toggle Show Asset Versions on Load",detailedDescription:"If enabled, will display the asset versions once the page loads",unlisted:!0},{keyCombo:"__ssc",description:"Set Host Panel Credentials",unlisted:!0},{keyCombo:"__ssp",description:"Copy Post ID to Clipboard",unlisted:!0},...o(e(8)).default.map(n=>({keyCombo:n.keyCombo,description:"A/B Test: "+n.description,unlisted:!0}))];t.default=i},function(n,t,e){"use strict";var o=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function a(n){try{l(o.next(n))}catch(n){s(n)}}function r(n){try{l(o.throw(n))}catch(n){s(n)}}function l(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,r)}l((o=o.apply(n,t||[])).next())}))},i=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t},s=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(e(3)),r=i(e(0)),l=s(e(1)),d=i(e(7));t.default=n=>o(void 0,void 0,void 0,(function*(){(yield a.get().isNotFirstRun)&&!n||(r.set(function(){const n=unsafeWindow.document.createElement("style");return n.innerHTML=`\n    @font-face {\n      font-family: "BigBlue TerminalPlus";\n      src: url('${GM_getResourceURL("bigBlueFont")}') format('truetype')\n    }\n  `,unsafeWindow.document.head.appendChild(n),`\n    <style>\n      @keyframes cta {\n        0% {\n          color: #ffffff;\n          text-shadow: inherit;\n        }\n        74.99% {\n          color: #ffffff;\n          text-shadow: inherit;\n        }\n        75% {\n          color: transparent;\n          text-shadow: none;\n        }\n        100% {\n          color: transparent;\n          text-shadow: none;\n        }\n      }\n\n      .wrapper {\n        margin: -7px -10px -18px;\n      }\n\n      .wrapper img {\n        width: 100%;\n        height: 294px;\n      }\n\n      .message {\n        text-align: left;\n        padding: 20px;\n        margin-bottom: -65px;\n      }\n\n      .message p:first-child {\n        margin-top: 0px;\n      }\n\n      .shortcut {\n        background: #FF37FD;\n        padding: 6px 8px;\n        border-radius: 5px;\n        box-shadow: 0px 0px 2px #000000a8;\n      }\n\n      .cta {\n        position: absolute;\n        bottom: 63px;\n        left: 21px;\n        animation: cta linear 1.4s infinite;\n        font-family: "BigBlue TerminalPlus";\n        -webkit-font-smoothing: none;\n        font-weight: normal;\n      }\n    </style>\n    <div class="wrapper">\n      <div class="message">\n        <p>👋 Welcome,</p>\n        <p>You can now hit <span class="shortcut">Ctrl+S</span> to open the command palette.</p>\n      </div>\n      <img src="${GM_getResourceURL("welcomeImage")}">\n      <p class="cta">Press Ctrl+S</p>\n    </div>\n  `}(),{color:l.default.default,title:"Welcome to Spot.IM Ninja Tools!"}),yield a.set({isNotFirstRun:!0}),yield d.setCurrentVersionAsLastShown())}))},function(n,t,e){"use strict";var o=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t},i=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(t,"__esModule",{value:!0});const s=o(e(14)),a=i(e(12)),r=i(e(21)),l=i(e(22)),d=o(e(7));l.default(),a.default(),r.default(),d.showIfUpgraded(),s.init()},function(n,t,e){"use strict";var o=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}},i=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t};Object.defineProperty(t,"__esModule",{value:!0});const s=o(e(6)),a=i(e(4)),r=i(e(0)),l=i(e(19));t.init=function(){let n,t=[];document.addEventListener("keydown",(function(n){n.key&&"escape"===n.key.toLowerCase()&&(a.stop(),r.hide(!0))})),document.addEventListener("keypress",(function(e){if(function(){var n,t;const e=document.activeElement;return(null===(n=e)||void 0===n?void 0:n.getAttribute("contenteditable"))||"INPUT"===(null===(t=e)||void 0===t?void 0:t.tagName)}())return;if(("s"===e.key.toLowerCase()||"ד"===e.key)&&e.ctrlKey)return void l.show();t.push(e.key.toLowerCase()),clearTimeout(n),!function(n){const t=s.default[n];return!!t&&(t(),!0)}(t.join(""))?n=setTimeout(()=>{t=[]},500):t=[]}))}},function(n,t,e){"use strict";var o=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function a(n){try{l(o.next(n))}catch(n){s(n)}}function r(n){try{l(o.throw(n))}catch(n){s(n)}}function l(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,r)}l((o=o.apply(n,t||[])).next())}))},i=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t},s=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(e(0)),r=i(e(2)),l=i(e(5)),d=s(e(1)),u=s(e(10));let c,p;function f(n){const[e,i]=u.default(["Delete Credentials","Cancel","Submit"]),s="\n      margin: 1em 2em 1.5em;\n    ",c="\n      font-weight: normal;\n      margin: 1em 0px;\n      text-align: left;\n    ",p="\n      display: flex;\n      align-items: baseline;\n      margin: 1em 3em;\n    ",f="\n      margin-right: 1em;\n      width: 120px;\n      text-align: right;\n    ",m="\n      text-align: left;\n      font-size: 0.8em;\n      font-weight: normal;\n      opacity: 0.8;\n    ",h="\n      position: absolute;\n      visibility: hidden\n    ",_=n?"Your host panel credentials are required.":"Enter your host panel credentials:";function g(){return o(this,void 0,void 0,(function*(){const e=l.get().querySelector("#emailInput").value.trim(),o=l.get().querySelector("#passwordInput").value.trim();e&&o&&(yield GM_setValue("email",e),yield GM_setValue("password",o),a.set("Your credentials were set!",{timeout:2e3,color:d.default.success,emoji:"😃"}),n&&setTimeout(()=>{t.open({spotId:r.getSpotId(r.getLauncherEl())})},2e3))}))}a.set(`\n      <form style="${s}">\n        <div style="${c}">${_}</div>\n        <div style="${p}">\n          <label style="${f}">Email</label>\n          <input id="emailInput" class="sptmninja_input" >\n        </div>\n        <div style="${p}">\n          <label style="${f}">Password</label>\n          <input id="passwordInput" class="sptmninja_input" type="password">\n        </div>\n        <div style="${m}">\n          If you're using Google to sign to the Host Panel this won't work.\n          You'll have to create an account using your email address to use\n          this feature.\n        </div>\n        <input style="${h}" type="submit"/>\n      </form>\n    ${e()}\n  `,{title:n?"Open Host Panel":"Set Host Panel Credentials",color:d.default.default}),setTimeout(()=>{l.get().querySelector("#emailInput").focus()},10),l.get().querySelector("form").addEventListener("submit",n=>{n.preventDefault(),g()}),i((function(n){return o(this,void 0,void 0,(function*(){2===n?g():1===n?a.hide(!0):(yield GM_setValue("email",""),yield GM_setValue("password",""),a.set("Your credentials were deleted!",{timeout:3e3,color:d.default.default,emoji:"👍🏻"}))}))}))}t.openCredentialsForm=f,t.open=({spotId:n})=>o(void 0,void 0,void 0,(function*(){if(p&&(c=window.open(p),p=null,a.set("Openning Host Panel...",{color:d.default.success,timeout:2e3})),c&&!c.closed)return void c.focus();const t=yield GM_getValue("email"),e=yield GM_getValue("password");if(!t||!e)return void f(!0);a.set("Fetching network id...",{color:d.default.default,step:0,numSteps:5,title:"Open Admin Panel"});var o=yield fetch("https://www.spot.im/api/me/network-id-by-name/spotim").then(n=>n.json());a.set("Fetching network token...",{color:d.default.default,step:1,numSteps:5,title:"Open Admin Panel"});var i=yield fetch(`https://www.spot.im/api/me/network-token/${o.network_id}`,{method:"post"}).then(n=>n.json());a.set("Logging in...",{color:d.default.default,step:2,numSteps:5,title:"Open Admin Panel"});var s=yield fetch("https://www.spot.im/api/email-connect/login",{method:"post",headers:new Headers({"x-spotim-networkid":o.network_id,"x-spotim-token":i.token,"Content-Type":"application/json"}),body:JSON.stringify({email:t,password:e})}).then(n=>n.json());if("EmailLogin_TooManyLoginAttemptsError"===s.type)return void a.set("Too many login attempts",{color:d.default.error,timeout:3500,emoji:"😕"});if(!1===s.success)return void a.set("Couldn't log in to Host Panel",{color:d.default.error,timeout:3500,emoji:"😕"});a.set("Fetching login json...",{color:d.default.default,step:3,numSteps:5,title:"Open Admin Panel"});yield fetch("https://www.spot.im/api/me/login-registered",{method:"post",headers:new Headers({"x-spotim-networkid":o.network_id,"x-spotim-token":i.token})}).then(n=>n.json());a.set("Calling me-make-admin...",{color:d.default.default,step:4,numSteps:5,title:"Open Admin Panel"});var l=yield fetch(`https://www.spot.im/api/moderation/internal/make-me-admin?spot_id=${n}`,{headers:new Headers({"x-spotim-networkid":o.network_id,"x-spotim-token":i.token})}).then(n=>n.json());a.set("Fetching token JSON...",{color:d.default.default,step:5,numSteps:5,title:"Open Admin Panel"});var u=yield fetch(`https://www.spot.im/api/me/token-by-ticket/${l.token_ticket}`,{method:"post"}).then(n=>n.json());const m=[`https://admin.${!r.isProduction(r.getLauncherEl())?"staging-":""}spot.im/spot/${n}/moderation?`,`name=${l.spot_name}&`,`token=${u.token}&`,`network_name=${u.network_name}`].join("");a.set("Opening Host Panel",{color:d.default.success,timeout:2e3,emoji:"😃"}),GM_openInTab(m,!1)}))},function(n,t,e){"use strict";var o=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function a(n){try{l(o.next(n))}catch(n){s(n)}}function r(n){try{l(o.throw(n))}catch(n){s(n)}}function l(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,r)}l((o=o.apply(n,t||[])).next())}))},i=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t},s=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(e(2)),r=i(e(0)),l=s(e(1));let d;function u(n,t){return!n.find(n=>{const e=t.find(t=>n.module===t.module&&n.name===t.name);return!e||(n.url!==e.url||void 0)})}function c(){return o(this,void 0,void 0,(function*(){let n;function t(){return o(this,void 0,void 0,(function*(){const t=a.getLauncherEl();let e;t?e=yield fetch(`https://api-2-0.spot.im/v1.0.0/config/launcher/${a.getSpotId(t)}/${a.getPostId(t)}/vendor,init,conversation`):unsafeWindow.location.href.match(/https:\/\/api-2-0.spot.im\/v1.0.0\/config\/launcher\/.*?\/.*?\/.*/)&&(e=yield fetch(unsafeWindow.location.href));const o=(yield e.json()).assets_config;var i,s;!n||u(i=o,s=n)&&u(s,i)||(p(),GM_notification({title:"An asset has been updated!",text:`${window.location.hostname} — Detected asset update`,onclick:()=>{window.focus()}}),r.set("An asset has been updated!",{color:l.default.default,emoji:"⬆️"})),n=o}))}t(),d=setInterval(t,1e3),r.set("I will notify you on asset updates!",{timeout:4e3,color:l.default.success,emoji:"😃"})}))}function p(n){clearInterval(d),d=!1,n&&r.set("Stopped listening to asset updates",{timeout:4e3,color:l.default.default,emoji:"❌"})}t.toggleNotifyOnChange=function(){d?p(!0):c()}},function(n,t,e){"use strict";var o=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t},i=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(t,"__esModule",{value:!0});const s=o(e(0)),a=o(e(2)),r=i(e(11)),l=i(e(1));t.show=()=>{s.set(a.renderTable([{keyCombo:"ctrl+s",description:"Open Command Palette"},...r.default,{keyCombo:"escape",description:"Hide Floating Message"}].map(n=>[`<span\n                  title="${n.unlisted?"This command is unlisted, no key combo assigned to it":""}"\n                  class="\n                    sptmninja_mono\n                    ${n.unlisted?"sptmninja_hidden":""}\n                  ">\n                  ${n.unlisted?"×":n.keyCombo}\n                </span>`,n.description+(n.detailedDescription?`<div class="sptmninja_detailed_description">${n.detailedDescription}</div>`:"")])),{color:l.default.default,title:"Available Shortcuts",overflow:"scroll"})}},function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=e(2);t.default=(()=>{const n=new Date;return n.getHours()+":"+o.padTime(n.getMinutes().toString())})()},function(n,t,e){"use strict";var o=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function a(n){try{l(o.next(n))}catch(n){s(n)}}function r(n){try{l(o.throw(n))}catch(n){s(n)}}function l(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,r)}l((o=o.apply(n,t||[])).next())}))},i=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}},s=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t};Object.defineProperty(t,"__esModule",{value:!0});const a=i(e(11)),r=s(e(4)),l=s(e(0)),d=s(e(2)),u=s(e(3)),c=i(e(1)),p=i(e(6)),f=s(e(5)),m=i(e(20));let h=0;function _(n){const t=n.target.closest(".sptmninja_tr");if(t&&t.children.length){const n=t.children[0].children[0].dataset.keyCombo,e=p.default[n];e&&e()}}t.show=function(){return o(this,void 0,void 0,(function*(){h=0;let n,t=yield(()=>o(this,void 0,void 0,(function*(){const{lastCommandThatRanKeyCombo:n}=yield u.get();if(n)return a.default.find(t=>t.keyCombo===n)})))();r.stop({hideMessage:!1});const e=l.set('<style>\n      .fuzzyHighlight {\n        color: #FFEB3B;\n        font-weight: bold;\n      }\n\n      .inputNotEmpty .sptmninja_pallete_row_main_col {\n        font-weight: normal;\n      }\n    </style>\n    <input class="sptmninja_input"><div class="sptmninja_results"></div>',{title:`${d.getLauncherEl(!1)?"":'<span class="sptmninja_titleIcon" title="Can\'t find Launcher script tag">⚠️</span>'}Start Typing A Command`,color:c.default.default});e.querySelector(".sptmninja_results").addEventListener("click",_);const i=f.get().querySelector(".sptmninja_input");function s(){const e=i.value,o=m.default.filter(e,a.default,{pre:'<span class="fuzzyHighlight">',post:"</span>",extract:n=>n.description});if(n=o.map(n=>Object.assign(Object.assign({},a.default[n.index]),{description:n.string})),!e&&t){const e=n.findIndex(n=>{var e;return n.keyCombo===(null===(e=t)||void 0===e?void 0:e.keyCombo)});n.splice(e,1),n.unshift(t)}}function g(o){i.value.trim()?e.querySelector(".sptmninja_results").classList.add("inputNotEmpty"):e.querySelector(".sptmninja_results").classList.remove("inputNotEmpty"),e.querySelector(".sptmninja_results").innerHTML=n.length?d.renderTable(n.map((n,e)=>[`<span class="sptmninja_mono ${n.unlisted?"sptmninja_hidden":""}" data-key-combo="${n.keyCombo}">${n.unlisted?"×":n.keyCombo}</span>`,`<span\n                  class="sptmninja_pallete_row_main_col ${h===e?"sptmninja_weight_bold":"sptmninja_muted_result"}"\n                  ${h===e?"data-selected":""}\n                  >\n                  <div class="palette_row_description">${n.description}</div>\n                  ${t===n?"<div class='palette_row_recently_used'>recently used</div>":""}\n                </span>`,h===e?d.createElement("⏎","muted_text"):""])):"";const s=f.get().querySelector("[data-selected]");if(s){const n=s.parentNode.parentNode;(function(n){const t=n.getBoundingClientRect(),e=f.get().querySelector(".sptmninja_results").getBoundingClientRect();return t.y>e.y&&t.bottom<e.bottom})(n)||n.scrollIntoView(o)}}s(),g(),i.focus(),i.addEventListener("keydown",e=>{if(38===e.keyCode)h--,h<0&&(h=n.length-1),e.preventDefault(),g(!0);else if(40===e.keyCode)h++,h>=n.length&&(h=0),e.preventDefault(),g(!1);else if(13===e.keyCode){if(function(){var e;const o=n[h];return t=o,u.set({lastCommandThatRanKeyCombo:null===(e=t)||void 0===e?void 0:e.keyCombo}),!!o&&(l.hide(!0),p.default[o.keyCombo](),!0)}())return}else g()}),i.addEventListener("keyup",t=>{s(),h>=n.length&&(h=Math.max(n.length-1,0)),38!==t.keyCode&&40!==t.keyCode&&g()})}))}},function(n,t,e){var o;o={},n.exports=o,o.simpleFilter=function(n,t){return t.filter((function(t){return o.test(n,t)}))},o.test=function(n,t){return null!==o.match(n,t)},o.match=function(n,t,e){e=e||{};var o,i=0,s=[],a=t.length,r=0,l=0,d=e.pre||"",u=e.post||"",c=e.caseSensitive&&t||t.toLowerCase();n=e.caseSensitive&&n||n.toLowerCase();for(var p=0;p<a;p++)o=t[p],c[p]===n[i]?(o=d+o+u,i+=1,l+=1+l):l=0,r+=l,s[s.length]=o;return i===n.length?(r=c===n?1/0:r,{rendered:s.join(""),score:r}):null},o.filter=function(n,t,e){return t&&0!==t.length?"string"!=typeof n?t:(e=e||{},t.reduce((function(t,i,s,a){var r=i;e.extract&&(r=e.extract(i));var l=o.match(n,r,e);return null!=l&&(t[t.length]={string:l.rendered,score:l.score,index:s,original:i}),t}),[]).sort((function(n,t){var e=t.score-n.score;return e||n.index-t.index}))):[]}},function(n,t,e){"use strict";var o=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function a(n){try{l(o.next(n))}catch(n){s(n)}}function r(n){try{l(o.throw(n))}catch(n){s(n)}}function l(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,r)}l((o=o.apply(n,t||[])).next())}))},i=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t},s=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(e(3)),r=s(e(6)),l=i(e(2));t.default=()=>o(void 0,void 0,void 0,(function*(){if((yield a.get()).showVersionsOnLoad){l.onFoundSpotimObject((function n(){unsafeWindow.__SPOTIM__.SERVICES.configProvider._data.assets_config?r.default.ssv():setTimeout(()=>{l.onFoundSpotimObject(n)},500)}))}}))},function(n,t,e){"use strict";var o=this&&this.__awaiter||function(n,t,e,o){return new(e||(e=Promise))((function(i,s){function a(n){try{l(o.next(n))}catch(n){s(n)}}function r(n){try{l(o.throw(n))}catch(n){s(n)}}function l(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,r)}l((o=o.apply(n,t||[])).next())}))},i=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t};Object.defineProperty(t,"__esModule",{value:!0});const s=i(e(3));t.default=()=>{unsafeWindow.__spotim_ninja_tools_set_creds__=(n,t)=>o(void 0,void 0,void 0,(function*(){yield GM_setValue("email",n),yield GM_setValue("password",t),console.log("successfully set creds!")})),unsafeWindow.__spotim_ninja_tools_set_prefs__=n=>o(void 0,void 0,void 0,(function*(){const t=yield s.get(),e=Object.assign(Object.assign({},t),n);yield s.set(e),console.log("successfully set prefs!"),console.log(e)}))}}]);